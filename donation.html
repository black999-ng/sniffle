<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Donate — Zygonetix Consult</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Minimal overrides for the donation page to blend with site */
    body { background: var(--bg-light); font-family: 'Poppins', sans-serif; }
    .donation-wrapper { max-width: 980px; margin: 3rem auto; padding: 1rem; }
    .card { background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.06); border:1px solid var(--border); }
    .p-8 { padding: 2rem; }
    .grid-amounts { display:grid; grid-template-columns: repeat(2, 1fr); gap:1rem; }
    @media(min-width:768px){ .grid-amounts{ grid-template-columns: repeat(3,1fr);} }
    .amount-btn{ padding:1.25rem; border-radius:10px; border:2px solid var(--border); background:transparent; font-weight:600 }
    .amount-btn.selected{ border-color:var(--accent); background: rgba(39,174,96,0.06); color:var(--accent); box-shadow:0 6px 18px rgba(39,174,96,0.08)}
    .input, .textarea { width:100%; padding:0.75rem; border-radius:8px; border:1px solid var(--border); }
    .btn-primary{ background:var(--accent); color:white; padding:0.75rem 1.25rem; border-radius:8px; border:none; font-weight:600 }
    .btn-ghost{ background:white; color:var(--text); border:1px solid var(--border); padding:0.5rem 0.75rem; border-radius:8px }
    .mt-6{ margin-top:1.5rem }
    .flex{ display:flex }
    .gap-4{ gap:1rem }
    .justify-end{ justify-content:flex-end }
  </style>
</head>
<body>
  <div class="donation-wrapper">
    <div class="card p-8">
      <h2 style="font-family: 'Montserrat', sans-serif; font-size:1.5rem; color:var(--primary)">Donate to Zygonetix Consult</h2>
      <p class="text-muted">Support our programs to improve livestock health and farmer livelihoods.</p>

      <div id="step-amount" class="mt-6">
        <h3 class="mb-2">Choose an amount</h3>
        <div class="grid-amounts" id="preset-list"></div>

        <div class="mt-6">
          <label class="text-sm">Custom Amount (NGN)</label>
          <div style="position:relative;">
            <span style="position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#888;font-weight:600">₦</span>
            <input id="custom-amount" class="input" style="padding-left:36px" type="number" min="100" placeholder="Enter custom amount" />
          </div>
        </div>

        <div class="mt-6">
          <button id="to-donor" class="btn-primary">Continue</button>
        </div>
      </div>

      <div id="step-donor" class="mt-6" style="display:none">
        <h3 class="mb-2">Donor Information</h3>
        <div style="display:grid;grid-template-columns:repeat(1,1fr);gap:1rem;">
          <input name="name" id="donor-name" class="input" placeholder="Full name" />
          <input name="email" id="donor-email" class="input" placeholder="Email address" />
          <input name="phone" id="donor-phone" class="input" placeholder="Phone (optional)" />
          <textarea id="donor-message" class="textarea" rows="3" placeholder="Message (optional)"></textarea>
        </div>
        <div class="mt-6 flex gap-4 justify-end">
          <button id="back-to-amount" class="btn-ghost">Back</button>
          <button id="to-payment" class="btn-primary">Proceed to Payment</button>
        </div>
      </div>

      <div id="step-payment" class="mt-6" style="display:none">
        <h3 class="mb-2">Choose Payment Method</h3>
        <div style="display:grid;gap:0.75rem;">
          <button data-method="Paystack" class="btn-ghost">Paystack</button>
          <button data-method="Flutterwave" class="btn-ghost">Flutterwave</button>
          <button data-method="Remita" class="btn-ghost">Remita</button>
        </div>
        <div class="mt-6 flex gap-4 justify-end">
          <button id="back-to-donor" class="btn-ghost">Back</button>
        </div>
      </div>

      <div id="step-receipt" class="mt-6" style="display:none">
        <h3 class="mb-2">Upload Payment Receipt</h3>
        <input id="receipt-file" type="file" accept="image/*,.pdf" />
        <div class="mt-6 flex gap-4 justify-end">
          <button id="back-to-payment" class="btn-ghost">Back</button>
          <button id="complete-donation" class="btn-primary" disabled>Complete Donation</button>
        </div>
      </div>

      <div id="step-success" class="mt-6" style="display:none">
        <h3 class="mb-2" style="color:var(--primary)">Thank you!</h3>
        <p>Your donation has been recorded. You can export donation records from this page.</p>
        <div class="mt-6 flex gap-4 justify-end">
          <button id="export-json" class="btn-primary">Export Records (JSON)</button>
        </div>
      </div>

    </div>
  </div>

<script>
(function(){
  const preset = [1000,2500,5000,10000,25000,50000];
  const presetList = document.getElementById('preset-list');
  const customAmount = document.getElementById('custom-amount');
  const toDonor = document.getElementById('to-donor');
  const stepAmount = document.getElementById('step-amount');
  const stepDonor = document.getElementById('step-donor');
  const stepPayment = document.getElementById('step-payment');
  const stepReceipt = document.getElementById('step-receipt');
  const stepSuccess = document.getElementById('step-success');
  const toPayment = document.getElementById('to-payment');
  const backToAmount = document.getElementById('back-to-amount');
  const backToDonor = document.getElementById('back-to-donor');
  const backToPayment = document.getElementById('back-to-payment');
  const receiptFile = document.getElementById('receipt-file');
  const completeDonation = document.getElementById('complete-donation');
  const exportJson = document.getElementById('export-json');

  let selectedAmount = null;
  let selectedMethod = null;
  let receiptData = null;

  // render presets
  preset.forEach(a => {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.className = 'amount-btn';
    btn.textContent = new Intl.NumberFormat('en-NG',{style:'currency',currency:'NGN',minimumFractionDigits:0}).format(a);
    btn.addEventListener('click', ()=>{
      selectedAmount = a; document.querySelectorAll('.amount-btn').forEach(b=>b.classList.remove('selected')); btn.classList.add('selected'); customAmount.value='';
    });
    presetList.appendChild(btn);
  });

  toDonor.addEventListener('click', ()=>{
    const amt = customAmount.value ? Number(customAmount.value) : selectedAmount;
    const name = document.getElementById('donor-name').value;
    const email = document.getElementById('donor-email').value;
    if(!amt || amt<100){ alert('Please select or enter an amount (min 100 NGN)'); return; }
    // Allow empty donor at this stage but follow original: require name/email on proceed to payment
    stepAmount.style.display='none'; stepDonor.style.display='block';
  });

  backToAmount.addEventListener('click', ()=>{ stepDonor.style.display='none'; stepAmount.style.display='block'; });

  toPayment.addEventListener('click', ()=>{
    const name = document.getElementById('donor-name').value.trim();
    const email = document.getElementById('donor-email').value.trim();
    if(!name||!email){ alert('Please provide your name and email'); return; }
    // basic email check
    if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ alert('Enter valid email'); return; }
    stepDonor.style.display='none'; stepPayment.style.display='block';
  });

  backToDonor.addEventListener('click', ()=>{ stepPayment.style.display='none'; stepDonor.style.display='block'; });

  // payment selection
  stepPayment.querySelectorAll('button[data-method]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      selectedMethod = btn.getAttribute('data-method');
      // simulate connecting
      btn.textContent = 'Connecting...';
      setTimeout(()=>{
        stepPayment.style.display='none'; stepReceipt.style.display='block';
        btn.textContent = selectedMethod;
      },1500);
    });
  });

  backToPayment.addEventListener('click', ()=>{ stepReceipt.style.display='none'; stepPayment.style.display='block'; });

  receiptFile.addEventListener('change', (e)=>{
    const f = e.target.files[0];
    if(!f) return; if(f.size>10*1024*1024){ alert('Max 10MB'); return; }
    const reader = new FileReader();
    reader.onload = ()=>{ receiptData = { name: f.name, type: f.type, data: reader.result }; completeDonation.disabled=false; };
    reader.readAsDataURL(f);
  });

  completeDonation.addEventListener('click', ()=>{
    const name = document.getElementById('donor-name').value.trim();
    const email = document.getElementById('donor-email').value.trim();
    const phone = document.getElementById('donor-phone').value.trim();
    const message = document.getElementById('donor-message').value.trim();
    const amount = customAmount.value ? Number(customAmount.value) : selectedAmount;
    const donation = { id:Date.now(), timestamp:new Date().toISOString(), name, email, phone, amount, message, paymentMethod:selectedMethod, receipt:receiptData };
    const existing = JSON.parse(localStorage.getItem('donations')||'[]'); existing.push(donation); localStorage.setItem('donations', JSON.stringify(existing));
    stepReceipt.style.display='none'; stepSuccess.style.display='block';
  });

  exportJson && exportJson.addEventListener('click', ()=>{
    const data = JSON.parse(localStorage.getItem('donations')||'[]');
    const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download = 'donations_'+(new Date().toISOString().split('T')[0])+'.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

})();
</script>
</body>
</html>